{
  "rules": {
    ".read": false,
    ".write": false,

    "render_state": {
      ".read": true,
      ".write": "auth != null && auth.token.firebase.sign_in_provider === 'anonymous' && root.child('screens/approved').child(auth.uid).val() == true",
      ".validate": "newData.hasChildren(['phase'])",
      "phase": {
        ".validate": "newData.isString() && newData.val().matches(/^(visible|hidden|showing|hiding|error)$/)"
      },
      "updatedAt": { ".validate": "newData.isNumber() || !newData.exists()" },
      "nowShowing": {
        ".validate": "!newData.exists() || (newData.hasChildren(['name','question']) && newData.child('name').isString() && newData.child('question').isString())"
      }
    },

    "currentTelop": {
      ".read": true,
      ".write": "auth != null && root.child('admins').child(auth.uid).val() == true"
    },

    "questions": {
      ".read": "auth != null",
      "$uid": {
        ".write": "auth != null && root.child('admins').child(auth.uid).val() == true",
        ".validate": "newData.hasChildren(['uid','name','question'])",
        "uid":       { ".validate": "newData.isString()" },
        "name":      { ".validate": "newData.isString()" },
        "question":  { ".validate": "newData.isString()" },
        "answered":  { ".validate": "newData.isBoolean() || !newData.exists()" },
        "selecting": { ".validate": "newData.isBoolean() || !newData.exists()" },
        "updatedAt": { ".validate": "newData.isNumber()  || !newData.exists()" },
        "$other":    { ".validate": false }
      }
    },

    "dictionary": {
      ".read": true,
      ".write": "auth != null && root.child('admins').child(auth.uid).val() == true"
    },

    "update_trigger": {
      ".read": true,
      ".write": "auth != null"
    },

    "admins": {
      ".read": false,
      ".write": "auth != null && root.child('admins').child(auth.uid).val() == true"
    },

    "render_control": {
      ".read": "auth != null && root.child('admins').child(auth.uid).val() == true",
      ".write": false
    },

    "screens": {
      "approved": {
        "$uid": {
          ".read": "auth != null && auth.token.firebase.sign_in_provider === 'anonymous' && auth.uid === $uid",
          ".write": false
        }
      },
      "sessions": {
        "$uid": {
          ".read": "auth != null && root.child('admins').child(auth.uid).val() == true",
          ".write": false
        }
      }
    }
  }
}
