<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Telop Operator</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
</head>
<body class="op-theme">
    <!-- ローディングオーバーレイ -->
    <div id="loading-overlay" aria-live="polite" hidden>
      <div class="loading-backdrop"></div>
      <div class="loading-panel" role="status" aria-label="読み込み中">
        <div class="spinner" aria-hidden="true"></div>
        <div class="loading-text"><span id="loading-text">サインイン中…</span></div>
        <div class="loading-sub">数秒かかる場合があります</div>
      </div>
    </div>
  <header class="op-header">
    <h1>Operator</h1>
    <div class="status-bar">
        <div class="brand">TELoP OPS</div>
        <div class="render-indicator" title="Display 状態">
            <span id="render-lamp" class="lamp"></span>
            <span id="render-phase" class="lamp-label">-</span>
        </div>
        <div class="render-summary" id="render-summary">
            <div class="render-line">
                <span class="label">表示中:</span>
                <span id="render-title" class="text-strong">—</span>
            </div>
            <div id="render-question" class="text-soft">—</div>
            <div id="render-updated" class="text-meta">—</div>
        </div>
    </div>
    <div id="user-info"></div>
  </header>
      
    <div id="login-container">
        <h2>テロップ操作パネル ログイン</h2>
        <button id="login-button">Googleアカウントでログイン</button>
    </div>

    <div id="main-container" style="display: none;">
        <div class="panel" id="questions-panel">
            <h1>テロップ操作パネル</h1>
            <div id="main-tab-buttons">
                <button class="main-tab-button active" data-tab="questions">質問</button>
                <button class="main-tab-button" data-tab="logs">操作ログ</button>
                <button id="manual-update-button">手動更新</button>
            </div>

            <div id="main-tab-contents">
                <div class="main-tab-content active" id="questions-content">
                    <div id="sub-tab-buttons">
                        <button class="sub-tab-button active" data-sub-tab="normal">通常質問</button>
                        <button class="sub-tab-button" data-sub-tab="puq">Pick Up Question</button>
                    </div>
<!--
                    <table id="questions-table">
                        <thead><tr>
                            <th style="width:32px"><input type="checkbox" id="select-all-checkbox"></th>
                            <th>班</th>
                            <th>ラジオネーム</th>
                            <th>質問・お悩み</th>
                            <th>状態</th>
                        </tr></thead>
                        <tbody></tbody>
                    </table>
-->
                    <!-- 質問リスト（カードビュー） -->
                    <div class="cards-toolbar">
                        <label class="chk">
                            <input id="select-all-checkbox" type="checkbox" />
                            全選択
                        </label>
                    </div>
                    <div id="questions-cards" class="cards-list" aria-live="polite"></div>
                </div>
                <div class="main-tab-content" id="logs-content">
                    <div id="logs-toolbar" style="display:flex;gap:12px;align-items:center;margin:8px 0;">
                      <input id="log-search" placeholder="検索 (user/action/details)" style="flex:1;max-width:340px;">
                      <label style="margin-left:auto;"><input type="checkbox" id="log-autoscroll" checked> 自動スクロール</label>
                    </div>
                    <div id="logs-stream-view">
                      <div id="log-stream" class="log-stream"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel" id="dictionary-panel">
            <h2>ルビ辞書管理</h2>
            <button id="fetch-dictionary-button">辞書を更新</button>
            <form id="add-term-form">
                <input type="text" id="new-term" placeholder="単語" required>
                <input type="text" id="new-ruby" placeholder="ルビ" required>
                <button type="submit">追加</button>
            </form>
            <table id="dictionary-table">
                <thead>
                    <tr><th>単語</th><th>ルビ</th><th>状態</th><th>操作</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    
    <div id="action-panel" style="display: none;">
        <button id="btn-display" disabled>表示</button>
        <button id="btn-unanswer" disabled>未回答にする</button> <button id="btn-edit" disabled>編集</button>
        <button id="btn-clear">テロップを消去</button>
        <span id="selected-info">行を選択してください</span>
        <div style="margin-left: auto;">
          <button id="btn-batch-unanswer" style="display: none;">選択した項目を未回答にする</button>
        </div>
    </div>
    
    <script type="module" src="operator.js"></script>
</body>
</html>
