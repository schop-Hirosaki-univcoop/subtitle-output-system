# index.html / events.html Audit

## 概要
- 対象: `index.html`, `events.html` とそれらが利用する主要スクリプト。
- 観点: UX/UI・デザイン、ロジック、セキュリティ。

## UX/UI・デザイン上の懸念
1. **ビューポート設定の欠如**  
   両ページとも `<meta name="viewport">` が存在せず、モバイル端末では極端な縮小表示やズーム操作が必要になる恐れがあります。特にイベント管理フローはボタンやリストが多く、レスポンシブ対応が不可欠です。【F:index.html†L1-L34】【F:events.html†L1-L40】
2. **進行ステップ表示のセマンティクス不足**  
   ステップ表示は `role="list"` を持ちながら、子要素に `role="listitem"` が付与されておらずスクリーンリーダーが構造を正しく解釈できません。`<ul><li>` への変更か、明示的なロール追加を検討してください。【F:events.html†L16-L30】
3. **タブコンポーネントのキーボード操作未対応**  
   タブ切り替えはクリックイベントしか設定されておらず、左右矢印キー・Home/End キーによる移動など WAI-ARIA Authoring Practices の推奨操作が欠けています。キーボード専用ユーザーには操作が困難です。【F:scripts/events/app.js†L199-L208】

## ロジック上の不具合
1. **「日程を追加」「再読み込み」ボタンが機能しない**  
   `queryDom()` で `flow-add-schedule-button` / `flow-schedule-refresh-button` の参照が取得されていないため、対応するイベントリスナーと無効化制御が一切効いていません。その結果ボタンを押しても `openScheduleDialog()` や `reloadSchedules()` が呼び出されず、日程追加ができません。【F:events.html†L74-L99】【F:scripts/events/dom.js†L1-L73】【F:scripts/events/app.js†L247-L258】【F:scripts/events/app.js†L1082-L1093】

## セキュリティ観点
1. **重大な脆弱性は確認できず**  
   Firebase ルールで `questionIntake` 以下の読み書きが管理者 UID に限定されていること、失敗時にはサインアウト処理が行われることから現状大きな穴は見当たりませんでした。【F:firebase.rules.json†L1-L196】【F:scripts/events/app.js†L360-L399】
2. **改善提案: 管理者チェック失敗時の情報露出**  
   ただし `console.error` で API エラー全体を出力している箇所が複数あり、バックエンドが詳細なエラーメッセージやトレースを返すとブラウザコンソールに露出します。`ensureAdminAccess()` の結果など、不要な情報をログに出さない運用・マスキングを検討してください。【F:scripts/events/app.js†L360-L371】

## 優先度案
1. 日程追加ボタンが機能しない不具合 (高優先度)。
2. ビューポート設定欠如によるモバイル UX 崩壊 (中～高優先度)。
3. アクセシビリティ改善項目 (中優先度)。
4. ログ出力の見直し (低優先度)。

## 次のアクション例
- `queryDom()` に不足しているボタン参照を追加し、関連ハンドラーが動作するか E2E で確認。
- 両 HTML の `<head>` にレスポンシブビューポートを追加し、主要ブレイクポイントを確認。
- タブ／ステップ表示の WAI-ARIA 実装を見直し、キーボード操作とスクリーンリーダー対応を強化。
- バックエンドのエラー詳細をクライアントに露出しないよう、`console.error` の扱いを整理。
