// dom.js: イベント管理画面向けのDOMユーティリティとテンプレート生成を担当します。
/**
 * イベント管理画面で参照する主要なDOM要素を一括で収集します。
 * null安全性を高め、呼び出し元でのクエリ重複を避けるために利用します。
 * @returns {Record<string, HTMLElement|null|Element[]>}
 */
export function queryDom() {
  return {
    main: document.getElementById("events-main"),
    flowStage: document.querySelector(".flow-stage"),
    flowStagePanels: document.getElementById("flow-stage-panels"),
    chatContainer: document.querySelector(".events-chat"),
    sidebarContainer: document.getElementById("events-sidebar"),
    eventsModule: document.querySelector('[data-panel="events"]'),
    schedulesModule: document.querySelector('[data-panel="schedules"]'),
    stageIndicators: Array.from(document.querySelectorAll("[data-stage-indicator]")),
    loading: document.getElementById("flow-events-loading"),
    loadingText: document.getElementById("flow-events-loading-text"),
    alert: document.getElementById("flow-events-alert"),
    eventList: document.getElementById("flow-event-list"),
    eventEmpty: document.getElementById("flow-event-empty"),
    eventSelectionNote: document.getElementById("flow-event-selection-note"),
    addEventButton: document.getElementById("flow-add-event-button"),
    eventPrintButton: document.getElementById("flow-events-print-button"),
    printPreviewDialog: document.getElementById("print-dialog"),
    printPreview: document.getElementById("print-preview"),
    printPreviewFrame: document.getElementById("print-preview-frame"),
    printPreviewMeta: document.getElementById("print-preview-meta"),
    printPreviewNote: document.getElementById("print-preview-note"),
    printPreviewPrintButton: document.getElementById("print-preview-print"),
    printPreviewCloseButton: document.getElementById("print-preview-close"),
    printSettingsForm: document.getElementById("print-settings-form"),
    printPaperSizeInput: document.getElementById("print-paper-size"),
    printCustomSizeField: document.getElementById("print-custom-size"),
    printCustomWidthInput: document.getElementById("print-custom-width"),
    printCustomHeightInput: document.getElementById("print-custom-height"),
    printOrientationInput: document.getElementById("print-orientation"),
    printMarginInput: document.getElementById("print-margin"),
    printShowHeaderInput: document.getElementById("print-show-header"),
    printRepeatHeaderInput: document.getElementById("print-repeat-header"),
    printShowPageNumberInput: document.getElementById("print-show-page-number"),
    printShowDateInput: document.getElementById("print-show-date"),
    printShowTimeInput: document.getElementById("print-show-time"),
    printShowPhoneInput: document.getElementById("print-show-phone"),
    printShowEmailInput: document.getElementById("print-show-email"),
    refreshButton: document.getElementById("flow-events-refresh-button"),
    backupButton: document.getElementById("events-backup-button"),
    restoreButton: document.getElementById("events-restore-button"),
    fullscreenButton: document.getElementById("events-fullscreen-button"),
    fullscreenPromptDialog: document.getElementById("flow-fullscreen-dialog"),
    fullscreenPromptEnterButton: document.getElementById("flow-fullscreen-enter-button"),
    fullscreenPromptStayButton: document.getElementById("flow-fullscreen-stay-button"),
    fullscreenPromptSupportNote: document.getElementById("flow-fullscreen-support-note"),
    metaNote: document.getElementById("events-meta"),
    logoutButton: document.getElementById("flow-logout-button"),
    userLabel: document.getElementById("flow-user-label"),
    eventSummaryPane: document.getElementById("flow-event-summary-pane"),
    eventSummaryName: document.getElementById("flow-event-summary-name"),
    eventSummarySchedules: document.getElementById("flow-event-summary-schedules"),
    eventSummaryParticipants: document.getElementById("flow-event-summary-participants"),
    eventSummaryActions: document.getElementById("flow-event-summary-actions"),
    eventSummaryCopyButton: document.getElementById("flow-event-summary-copy"),
    eventSummaryCopyStatus: document.getElementById("flow-event-summary-copy-status"),
    eventSummaryGotoScheduleButton: document.getElementById("flow-event-summary-goto-schedule"),
    scheduleLoading: document.getElementById("flow-schedule-loading"),
    scheduleLoadingText: document.getElementById("flow-schedule-loading-text"),
    scheduleSelectionNote: document.getElementById("flow-schedule-selection-note"),
    scheduleCommittedNote: document.getElementById("flow-schedule-committed-note"),
    scheduleCommittedLabel: document.getElementById("flow-schedule-committed-label"),
    addScheduleButton: document.getElementById("flow-add-schedule-button"),
    scheduleRefreshButton: document.getElementById("flow-schedule-refresh-button"),
    scheduleNextButton: document.querySelector('[data-panel="schedules"] [data-flow-nav-target="participants"]'),
    scheduleSummary: document.getElementById("flow-schedule-summary"),
    scheduleSummaryEmpty: document.getElementById("flow-schedule-summary-empty"),
    scheduleSummaryLabel: document.getElementById("flow-schedule-summary-label"),
    scheduleSummaryRange: document.getElementById("flow-schedule-summary-range"),
    scheduleSummaryRangeRow: document.getElementById("flow-schedule-summary-range-row"),
    scheduleSummaryLocation: document.getElementById("flow-schedule-summary-location"),
    scheduleSummaryLocationRow: document.getElementById("flow-schedule-summary-location-row"),
    scheduleList: document.getElementById("flow-schedule-list"),
    scheduleEmpty: document.getElementById("flow-schedule-empty"),
    eventActionPanel: document.getElementById("flow-event-action-panel"),
    eventEditButton: document.getElementById("flow-event-edit-button"),
    eventDeleteButton: document.getElementById("flow-event-delete-button"),
    eventSelectedInfo: document.getElementById("flow-event-selected-info"),
    eventBatchDeleteButton: document.getElementById("flow-event-batch-delete-button"),
    scheduleActionPanel: document.getElementById("flow-schedule-action-panel"),
    scheduleEditButton: document.getElementById("flow-schedule-edit-button"),
    scheduleDeleteButton: document.getElementById("flow-schedule-delete-button"),
    scheduleSelectedInfo: document.getElementById("flow-schedule-selected-info"),
    scheduleBatchDeleteButton: document.getElementById("flow-schedule-batch-delete-button"),
    operatorModeDialog: document.getElementById("flow-operator-mode-dialog"),
    operatorModeForm: document.getElementById("flow-operator-mode-form"),
    operatorModeOptions: document.getElementById("flow-operator-mode-options"),
    operatorModeSummary: document.getElementById("flow-operator-mode-summary"),
    operatorModeError: document.getElementById("flow-operator-mode-error"),
    operatorModeCancelButton: document.getElementById("flow-operator-mode-cancel-button"),
    eventDialog: document.getElementById("flow-event-dialog"),
    eventForm: document.getElementById("flow-event-form"),
    eventDialogTitle: document.getElementById("flow-event-dialog-title"),
    eventNameInput: document.getElementById("flow-event-name-input"),
    eventError: document.getElementById("flow-event-error"),
    scheduleDialog: document.getElementById("flow-schedule-dialog"),
    scheduleForm: document.getElementById("flow-schedule-form"),
    scheduleDialogTitle: document.getElementById("flow-schedule-dialog-title"),
    scheduleLabelInput: document.getElementById("flow-schedule-label-input"),
    scheduleLocationInput: document.getElementById("flow-schedule-location-input"),
    scheduleLocationList: document.getElementById("flow-schedule-location-list"),
    scheduleDateInput: document.getElementById("flow-schedule-date-input"),
    scheduleStartInput: document.getElementById("flow-schedule-start-input"),
    scheduleEndInput: document.getElementById("flow-schedule-end-input"),
    scheduleRecruitGlInput: document.getElementById("flow-schedule-recruit-gl-input"),
    scheduleDialogCalendar: document.getElementById("flow-schedule-dialog-calendar"),
    scheduleDialogCalendarTitle: document.getElementById("flow-schedule-dialog-calendar-title"),
    scheduleDialogCalendarGrid: document.getElementById("flow-schedule-dialog-calendar-grid"),
    scheduleDialogCalendarPrev: document.getElementById("flow-schedule-dialog-calendar-prev"),
    scheduleDialogCalendarNext: document.getElementById("flow-schedule-dialog-calendar-next"),
    scheduleError: document.getElementById("flow-schedule-error"),
    scheduleConflictDialog: document.getElementById("flow-schedule-conflict-dialog"),
    scheduleConflictForm: document.getElementById("flow-schedule-conflict-form"),
    scheduleConflictOptions: document.getElementById("flow-schedule-conflict-options"),
    scheduleConflictError: document.getElementById("flow-schedule-conflict-error"),
    scheduleConflictPresence: document.getElementById("flow-schedule-conflict-presence"),
    scheduleConflictPresenceEmpty: document.getElementById("flow-schedule-conflict-presence-empty"),
    scheduleConflictConfirmButton: document.getElementById("flow-schedule-conflict-confirm-button"),
    scheduleConflictDescription: document.getElementById("flow-schedule-conflict-description"),
    scheduleFallbackDialog: document.getElementById("flow-schedule-fallback-dialog"),
    scheduleFallbackForm: document.getElementById("flow-schedule-fallback-form"),
    scheduleFallbackSummary: document.getElementById("flow-schedule-fallback-summary"),
    scheduleFallbackCurrent: document.getElementById("flow-schedule-fallback-current"),
    scheduleFallbackOptions: document.getElementById("flow-schedule-fallback-options"),
    scheduleFallbackError: document.getElementById("flow-schedule-fallback-error"),
    scheduleFallbackConfirmButton: document.getElementById("flow-schedule-fallback-confirm-button"),
    scheduleConsensusToast: document.getElementById("flow-schedule-consensus-toast"),
    scheduleCompletionDialog: document.getElementById("flow-schedule-completion-dialog"),
    scheduleCompletionCloseButton: document.getElementById("flow-schedule-completion-close-button"),
    scheduleCompletionCopyButton: document.getElementById("flow-completion-copy-url"),
    scheduleCompletionCopyStatus: document.getElementById("flow-completion-copy-status"),
    scheduleCompletionButtons: Array.from(document.querySelectorAll("#flow-schedule-completion-dialog [data-panel-target]")),
    confirmDialog: document.getElementById("flow-confirm-dialog"),
    confirmDialogTitle: document.getElementById("flow-confirm-dialog-title"),
    confirmDialogMessage: document.getElementById("flow-confirm-dialog-message"),
    confirmAcceptButton: document.getElementById("flow-confirm-accept-button"),
    confirmCancelButton: document.getElementById("flow-confirm-cancel-button"),
    internalStaffRegistrationDialog: document.getElementById("flow-internal-staff-registration-dialog"),
    internalStaffRegistrationForm: document.getElementById("flow-internal-staff-registration-form"),
    internalStaffRegistrationEventSelect: document.getElementById("flow-internal-staff-event-select"),
    internalStaffRegistrationNameInput: document.getElementById("flow-internal-staff-name"),
    internalStaffRegistrationEmailInput: document.getElementById("flow-internal-staff-email"),
    internalStaffRegistrationPhoneticInput: document.getElementById("flow-internal-staff-phonetic"),
    internalStaffRegistrationGradeInput: document.getElementById("flow-internal-staff-grade"),
    internalStaffRegistrationGenderInput: document.getElementById("flow-internal-staff-gender"),
    internalStaffRegistrationFacultyInput: document.getElementById("flow-internal-staff-faculty"),
    internalStaffRegistrationAcademicFields: document.getElementById("flow-internal-staff-academic-fields"),
    internalStaffRegistrationAcademicSelectTemplate: document.getElementById("flow-internal-staff-academic-select-template"),
    internalStaffRegistrationAcademicCustomField: document.getElementById("flow-internal-staff-academic-custom-field"),
    internalStaffRegistrationAcademicCustomLabel: document.getElementById("flow-internal-staff-academic-custom-label"),
    internalStaffRegistrationAcademicCustomInput: document.getElementById("flow-internal-staff-academic-custom"),
    internalStaffRegistrationClubInput: document.getElementById("flow-internal-staff-club"),
    internalStaffRegistrationStudentIdInput: document.getElementById("flow-internal-staff-student-id"),
    internalStaffRegistrationNoteInput: document.getElementById("flow-internal-staff-note"),
    internalStaffRegistrationError: document.getElementById("flow-internal-staff-registration-error"),
    internalStaffRegistrationCancelButton: document.getElementById("flow-internal-staff-registration-cancel-button"),
    internalStaffRegistrationSubmitButton: document.getElementById("flow-internal-staff-registration-submit-button"),
    participantsPanel: document.getElementById("flow-panel-participants"),
    glPanel: document.getElementById("flow-panel-gl"),
    operatorPanel: document.getElementById("flow-panel-operator"),
    dictionaryPanel: document.getElementById("op-dictionary-panel"),
    pickupPanel: document.getElementById("op-pickup-panel"),
    logsPanel: document.getElementById("op-logs-panel"),
    participantsTool: document.getElementById("participants-tool"),
    operatorTool: document.getElementById("operator-tool"),
    chatPanel: document.getElementById("flow-chat-panel"),
    chatAttention: document.getElementById("flow-chat-attention"),
    chatAttentionCount: document.getElementById("flow-chat-attention-count"),
    chatAttentionText: document.getElementById("flow-chat-attention-text"),
    chatMobileToggle: document.getElementById("events-chat-toggle"),
    chatMobileBadge: document.getElementById("events-chat-badge"),
    chatMobileBadgeText: document.getElementById("events-chat-badge-text"),
    chatStatus: document.getElementById("flow-chat-status"),
    chatScroll: document.getElementById("flow-chat-scroll"),
    chatMessages: document.getElementById("flow-chat-messages"),
    chatEmpty: document.getElementById("flow-chat-empty"),
    chatForm: document.getElementById("flow-chat-form"),
    chatReplyPreview: document.getElementById("flow-chat-reply"),
    chatReplyAuthor: document.getElementById("flow-chat-reply-author"),
    chatReplyText: document.getElementById("flow-chat-reply-text"),
    chatReplyDismiss: document.getElementById("flow-chat-reply-cancel"),
    chatInput: document.getElementById("flow-chat-input"),
    chatSendButton: document.getElementById("flow-chat-send-button"),
    chatError: document.getElementById("flow-chat-error"),
    chatUnreadButton: document.getElementById("flow-chat-unread-button"),
    chatUnreadCount: document.getElementById("flow-chat-unread-count"),
    chatContextMenu: document.getElementById("flow-chat-menu"),
    chatContextCancelButton: document.getElementById("flow-chat-menu-cancel"),
    glConfigStatus: document.getElementById("gl-config-status"),
    glConfigEventNote: document.getElementById("gl-config-event-note"),
    glConfigContent: document.getElementById("gl-config-content"),
    glTabList: document.getElementById("gl-tablist"),
    glTabConfigButton: document.getElementById("gl-tab-config"),
    glTabApplicationsButton: document.getElementById("gl-tab-applications"),
    glTabpanelConfig: document.getElementById("gl-tabpanel-config"),
    glTabpanelApplications: document.getElementById("gl-tabpanel-applications"),
    glPeriodStartInput: document.getElementById("gl-period-start"),
    glPeriodEndInput: document.getElementById("gl-period-end"),
    glFacultyBuilder: document.getElementById("gl-faculty-builder"),
    glFacultyList: document.getElementById("gl-faculty-list"),
    glFacultyEmpty: document.getElementById("gl-faculty-empty"),
    glFacultyAddButton: document.getElementById("gl-faculty-add"),
    glFacultyTemplate: document.getElementById("gl-faculty-template"),
    glFacultyLevelTemplate: document.getElementById("gl-faculty-level-template"),
    glFacultyOptionTemplate: document.getElementById("gl-faculty-option-template"),
    glTeamCountInput: document.getElementById("gl-team-count"),
    glConfigSaveButton: document.getElementById("gl-config-save"),
    glConfigCopyButton: document.getElementById("gl-config-copy"),
    glConfigCopyStatus: document.getElementById("gl-config-copy-status"),
    glFacultySummary: document.getElementById("gl-faculty-summary"),
    glFacultySharedMeta: document.getElementById("gl-faculty-shared-meta"),
    glFacultyPreview: document.getElementById("gl-faculty-preview"),
    glFacultySyncButton: document.getElementById("gl-faculty-sync"),
    glFacultyOpenButton: document.getElementById("gl-faculty-open"),
    glScheduleTeamsContainer: document.getElementById("gl-schedule-teams"),
    glScheduleTeamsList: document.getElementById("gl-schedule-teams-body"),
    glScheduleTeamsEmpty: document.getElementById("gl-schedule-teams-empty"),
    glScheduleTeamTemplate: document.getElementById("gl-schedule-team-template"),
    glFilterSelect: document.getElementById("gl-filter"),
    glApplicationBoard: document.getElementById("gl-application-board"),
    glApplicationViews: document.getElementById("gl-application-views"),
    glApplicationViewTabs: document.getElementById("gl-application-view-tabs"),
    glApplicationViewScheduleButton: document.getElementById("gl-view-schedule"),
    glApplicationViewApplicantButton: document.getElementById("gl-view-applicant"),
    glApplicationViewInternalButton: document.getElementById("gl-view-internal"),
    glApplicationViewSchedulePanel: document.getElementById("gl-application-view-schedule"),
    glApplicationViewApplicantPanel: document.getElementById("gl-application-view-applicant"),
    glApplicationViewInternalPanel: document.getElementById("gl-application-view-internal"),
    glApplicationList: document.getElementById("gl-application-list"),
    glApplicantSourceFilter: document.getElementById("gl-source-filter"),
    glApplicantRoleFilter: document.getElementById("gl-role-filter"),
    glPrintButton: document.getElementById("gl-print-button"),
    glApplicationEventNote: document.getElementById("gl-application-event-note"),
    glApplicationEmpty: document.getElementById("gl-application-empty"),
    glApplicationLoading: document.getElementById("gl-application-loading"),
    glInternalForm: document.getElementById("gl-internal-form"),
    glInternalIdInput: document.getElementById("gl-internal-id"),
    glInternalNameInput: document.getElementById("gl-internal-name"),
    glInternalPhoneticInput: document.getElementById("gl-internal-phonetic"),
    glInternalEmailInput: document.getElementById("gl-internal-email"),
    glInternalGradeInput: document.getElementById("gl-internal-grade"),
    glInternalGenderInput: document.getElementById("gl-internal-gender"),
    glInternalFacultyInput: document.getElementById("gl-internal-faculty"),
    glInternalAcademicFields: document.getElementById("gl-internal-academic-fields"),
    glInternalAcademicSelectTemplate: document.getElementById("gl-internal-academic-select-template"),
    glInternalAcademicCustomField: document.getElementById("gl-internal-academic-custom-field"),
    glInternalAcademicCustomLabel: document.getElementById("gl-internal-academic-custom-label"),
    glInternalAcademicCustomInput: document.getElementById("gl-internal-academic-custom"),
    glInternalClubInput: document.getElementById("gl-internal-club"),
    glInternalStudentIdInput: document.getElementById("gl-internal-student-id"),
    glInternalNoteInput: document.getElementById("gl-internal-note"),
    glInternalShiftList: document.getElementById("gl-internal-shifts"),
    glInternalSubmitButton: document.getElementById("gl-internal-submit"),
    glInternalResetButton: document.getElementById("gl-internal-reset"),
    glInternalDeleteButton: document.getElementById("gl-internal-delete"),
    glInternalStatus: document.getElementById("gl-internal-status"),
    glInternalList: document.getElementById("gl-internal-list"),
    glFacultyPanel: document.getElementById("flow-panel-gl-faculties"),
    glFacultyAdminStatus: document.getElementById("gl-faculty-admin-status"),
    glFacultyAdminLoading: document.getElementById("gl-faculty-admin-loading"),
    glFacultyAdminContent: document.getElementById("gl-faculty-admin-content"),
    glFacultyAdminUpdated: document.getElementById("gl-faculty-admin-updated"),
    glFacultyAdminSaveButton: document.getElementById("gl-faculty-admin-save"),
    glFacultyAdminResetButton: document.getElementById("gl-faculty-admin-reset"),
    panelButtons: Array.from(document.querySelectorAll("[data-panel-target]")),
    sidebarPanelButtons: (() => {
      const sidebar = document.getElementById("events-sidebar");
      if (!sidebar) return [];
      return Array.from(sidebar.querySelectorAll("[data-panel-target]"));
    })(),
    navigationButtons: Array.from(document.querySelectorAll("[data-flow-nav-target]")),
    flowNavigations: Array.from(document.querySelectorAll(".flow-navigation")),
    mobileToggleButtons: Array.from(document.querySelectorAll("[data-mobile-target]")),
    mobileCloseButtons: Array.from(document.querySelectorAll("[data-mobile-close]")),
    mobileOverlay: document.getElementById("events-mobile-overlay")
  };
}
